# DIYカッティングサービス

## 1. はじめに

### 1.1 背景

DIY 市場では板材を希望のサイズ・形状にカットして届けてもらいたいというニーズが高まっている。一方で中小零細の木材加工業者はオンライン集客や見積対応の手段が限られている。本サービスは **ユーザー・加工業者・アフィリエイター** をマッチングし、見積依頼から決済・発送までをワンストップで提供するプラットフォームである。

### 1.2 目的

- ユーザーが最適な加工業者を簡単に見つけ、安心して依頼できること
- 業者が手間なくオンラインで受注し、売上を拡大できること
- アフィリエイターが DIY 体験記事を通じて集客し、成果報酬を得られること

---

## 2. 用語定義

| 用語      | 説明                           |
| ------- | ---------------------------- |
| ユーザー    | 板材のカット・塗装などを依頼したい個人/法人       |
| 業者      | 木材加工や塗装等を行い見積提出・製造・発送を行う事業者  |
| アフィリエイト | ブログやSNS等でサービスを紹介し、成果報酬を得る利用者 |
| 見積      | ユーザーの要望に対し業者が提示する価格・納期情報     |
| NGリスト   | ユーザーまたは業者が取引を避けたい相手を登録するリスト  |

---

## 3. サービス全体像

```
ユーザー  ──(見積依頼/チャット)──▶ 業者
   ▲                                │
   │                                ▼
アフィリエイト ──(送客)──▶  サイト  ──(報酬)──▶ アフィリエイト
```

---

## 4. 機能要件

### 4.1 共通

| ID   | 機能           | 概要                         |
| ---- | ------------ | -------------------------- |
| C-01 | アカウント登録/ログイン | メール・SNS(OAuth) 対応          |
| C-02 | プロフィール管理     | 基本情報、アイコン、通知設定             |
| C-03 | 通知           | メール/プッシュ通知の二系統。重要イベントは必須通知 |
| C-04 | 全文検索         | 材料・業者・体験記事を横断検索            |
| C-05 | 多言語対応 (将来)   | i18n フレームワークで英語/日本語切替      |

### 4.2 ユーザー機能

| ID   | 機能      | 概要                          | 補足/不足部分への追記       |
| ---- | ------- | --------------------------- | ----------------- |
| U-01 | 材料選択    | 樹種・厚み・寸法(巾,長さ)・枚数           | 平面形状（矩形/円/アール半径）  |
| U-02 | 加工オプション | 平面加工(角R)・丸穴/四角穴・断面加工・塗装     | **板取り自動計算** を追加   |
| U-03 | カート     | 複数材料/加工内容を保存、数量変更           | ―                 |
| U-04 | 見積依頼    | 複数業者を一括指名 or 同一地域自動レコメンド    | お気に入り/NGリスト機能     |
| U-05 | チャット    | 見積単位のスレッド式チャット              | ファイル添付（図面・写真）     |
| U-06 | 注文・支払   | 選択した見積を元にクレカ/コンビニ/PayPay 決済 | キャンセル/再見積フロー      |
| U-07 | 受取・評価   | 完成品受領報告と★★★★★評価+コメント        | 追跡番号自動連携          |
| U-08 | マイページ   | 履歴参照・リピート注文・配送先住所帳          | **領収書PDF ダウンロード** |
| U-09 | 体験記事投稿 | 作業工程や完成品写真、コツを記事として投稿    | タグ・いいね・公開/非公開設定 |

### 4.3 業者機能

| ID   | 機能      | 概要                     | 補足               |
| ---- | ------- | ---------------------- | ---------------- |
| V-01 | 顧客獲得DM  | 登録ユーザー全員へ一括DM (初期制限付き) | スパム防止のため1日上限設定   |
| V-02 | 見積受信・回答 | 見積ごとに価格・納期・コメント返信      | テンプレート回答         |
| V-03 | チャット    | ユーザーと継続スレッド            | AI翻訳オプション        |
| V-04 | 受注管理    | 製作→梱包→発送 ステータス更新       | **QRコード貼付ラベル出力** |
| V-05 | 売上管理    | 受取済み売上/振込予定一覧          | CSV エクスポート       |
| V-06 | 請求書発行   | 法人向けインボイス制度対応          | PDF              |
| V-07 | 有料オプション | 「見積件数表示」「検索上位表示」       | Stripe サブスク      |
| V-08 | 施工事例記事投稿 | 加工事例やノウハウを記事として投稿       | ユーザーへのPR/SEO強化 |

### 4.4 アフィリエイト機能

| ID   | 機能      | 概要              | 補足      |
| ---- | ------- | --------------- | ------- |
| A-01 | 紹介リンク発行 | ブログ・SNS用短縮URL生成 | UTM自動付与 |
| A-02 | 成果報酬確認  | クリック、登録、成約別レポート | グラフ表示   |
| A-03 | 振込申請    | 最低支払額到達後に申請     | 手数料管理   |

### 4.5 管理者機能（追加）

| ID     | 機能      | 概要                    |
| ------ | ------- | --------------------- |
| ADM-01 | ダッシュボード | 登録数・GMV・CVR をリアルタイム表示 |
| ADM-02 | ユーザー管理  | 検索/停止/削除              |
| ADM-03 | 取引監視    | 通報対応、チャット閲覧、強制キャンセル   |
| ADM-04 | 手数料設定   | 業者手数料・アフィリエイト料率       |
| ADM-05 | CMS     | お知らせ・FAQ・LP コンテンツ編集   |

---

## 5. 非機能要件

| カテゴリ    | 要求                                   |
| ------- | ------------------------------------ |
| パフォーマンス | 平均レスポンス < 500ms、同時接続 5,000 を想定       |
| 可用性     | 年間稼働率 99.5% 以上                       |
| セキュリティ  | OWASP Top10 対策、TLS1.3、個人情報暗号化、2FA    |
| 拡張性     | マイクロサービス / Kubernetes                |
| 保守性     | Terraform + GitHub Actions による CI/CD |
| 法令遵守    | 特商法、個人情報保護法、インボイス制度                  |

---

## 6. 外部連携

- **決済**: Stripe / ペイジェント
- **配送**: 佐川 e飛伝・ヤマトB2 API
- **ストレージ**: AWS S3 (図面・チャット添付)
- **メール / Push**: Amazon SES / Firebase Cloud Messaging
- **SNSシェア**: X, Instagram, Pinterest

---

## 7. 画面一覧 & 遷移概要

| 画面ID | 名称           | 主なUI要素                |
| ---- | ------------ | --------------------- |
| P-01 | トップページ       | 体験紹介カード, ログインボタン      |
| P-02 | サービス紹介       | 利用フロー, FAQ            |
| P-03 | ログイン         | メール/各種SNSボタン          |
| P-04 | 新規登録         | ユーザー / 業者 / アフィリエイトタブ |
| P-05 | ユーザーマイページ    | 基本情報, 履歴, NG/Fav 編集   |
| P-06 | 見積依頼作成       | フォーム + 材料追加モーダル       |
| P-07 | 見積一覧         | ステータス別タブ              |
| P-08 | 見積詳細         | チャット, 発注ボタン           |
| P-09 | 注文支払         | 支払方法選択, 請求概要          |
| P-10 | 受取・評価        | ステータスバー, 星評価          |
| P-11 | 体験紹介         | SNS風タイムライン, いいね       |
| V-01 | 業者マイページ      | 基本情報, 見積可否設定, 売上情報    |
| A-01 | アフィリエイトマイページ | 基本情報, 成果報酬履歴          |

---
## 8. データモデル

### [DB テーブル一覧](docs/db/tables.md)参照

- users
- member_details
- vendor_details
- affiliate_details
- ...
---

## 9. 料金・課金モデル

1. **取引手数料**: 注文額の 8% をプラットフォームが徴収
2. **業者向け月額プラン**
   - フリー: 見積件数上限 30/月
   - プロ: 5,000円/月, 上限なし, 検索上位表示
3. **アフィリエイト報酬**: 成約額の 3%（初回のみ）

---

## 10. 開発ロードマップ（概要）

| Phase | 期間         | 主要マイルストーン            |
| ----- | ---------- | -------------------- |
| 0     | 〜2025/01   | UIデザイン, 要件FIX, 技術選定  |
| 1     | 2025/02〜04 | MVP実装 (ユーザー・業者機能の核心) |
| 2     | 2025/05〜06 | 決済・配送API, アフィリエイト機能  |
| 3     | 2025/07    | 公開β, 負荷試験            |
| 4     | 2025/08    | 正式リリース               |

---

### 付録 A. リスクと対応案

- **業者のレスポンス遅延** → SLA 設定 & 自動リマインド
- **不良品・クレーム** → 仲裁窓口 & エスクロー機構
- **スパムDM** → レートリミット & 通報ボタン

